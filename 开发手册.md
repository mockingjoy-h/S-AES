S-AES程序开发手册
=
一、简介
-
本开发手册提供了一个基于S-AES（Simplified Data Encryption Standard）算法的加解密程序的详细接口文档，用于对简单、规模小的数据进行加密、解密与中间相遇攻击操作，同时提供一个CBC模式的加解密功能。  

二、关键类的接口文档
-
1.ASCII类提供了使用给定密钥加密和解密ASCII明文的方法。该类包含以下方法：  
asciiEncipher(String Begin, String Key)  
该方法接受明文字符串Begin和16个字符的密钥Key，并返回加密后的字符串。该方法将每个字符转换为其ASCII值，将ASCII值转换为二进制，使用给定密钥的Cipher.cipher()方法加密二进制值，将加密的二进制值转换回十进制，
然后将十进制值转换回其对应的ASCII字符。该方法返回加密后的字符串。  
  
asciiEncipher2(String Begin, String Key)  
该方法接受明文字符串Begin和32个字符的密钥Key，并返回加密后的字符串。该方法首先将密钥分成两个16个字符的密钥，使用asciiEncipher()方法使用第一个密钥加密明文，然后使用第二个密钥加密结果字符串。
该方法返回加密后的字符串。  
  
asciiEncipher3(String input, String key)  
该方法接受明文字符串input和48个字符的密钥key，并返回加密后的字符串。该方法首先将密钥分成三个16个字符的密钥，使用第一个密钥使用  
  
asciiEncipher()方法加密明文，使用第二个密钥使用asciiDecipher()方法解密结果字符串，然后使用第三个密钥使用asciiEncipher()方法加密结果字符串。该方法返回加密后的字符串。  
  
asciiDecipher(String Begin, String Key)  
该方法接受加密后的字符串Begin和16个字符的密钥Key，并返回解密后的明文字符串。该方法将每个字符转换为其ASCII值，将ASCII值转换为二进制，使用给定密钥的Decipher.decipher()方法解密二进制值，
将解密的二进制值转换回十进制，然后将十进制值转换回其对应的ASCII字符。该方法返回解密后的明文字符串。  
  
asciiDecipher2(String input, String key)  
该方法接受加密后的字符串input和32个字符的密钥key，并返回解密后的明文字符串。该方法首先将密钥分成两个16个字符的密钥，使用asciiDecipher()方法使用第一个密钥解密加密后的字符串，
然后使用第二个密钥解密结果字符串。该方法返回解密后的明文字符串。  
  
asciiDecipher3(String input, String key)  
该方法接受加密后的字符串input和48个字符的密钥key，并返回解密后的明文字符串。该方法首先将密钥分成三个16个字符的密钥，使用第三个密钥使用  
asciiDecipher()方法解密加密后的字符串，使用第二个密钥使用  
asciiEncipher()方法加密结果字符串，然后使用第一个密钥使用  
asciiDecipher()方法解密结果字符串。该方法返回解密后的明文字符串。  
  
decimalToBinary(int decimalNumber)  
该方法接受一个整数decimalNumber，并将其转换为其二进制表示形式的字符串。该方法使用前导零填充二进制表示形式，以确保字符串长度为16位。  
  
binaryToDecimal(String binaryString)  
该方法接受一个二进制字符串binaryString，并将其转换为其十进制表示形式的整数。 
  
2.RoundKey类提供了一些方法，用于生成AES加密算法中的轮密钥。该类包含以下方法：  
Half_Byte_Replace(String a)  
该方法接受一个16位的二进制字符串a，并返回一个16位的二进制字符串。该方法将输入字符串分成两个8位的字符串，将每个8位字符串转换为十进制，使用SBox.s_box()方法将每个十进制值替换为S盒中的值，
然后将每个替换后的值转换为8位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
Half_Byte_Replace_1(String a)  
该方法接受一个16位的二进制字符串a，并返回一个16位的二进制字符串。该方法将输入字符串分成两个8位的字符串，将每个8位字符串转换为十进制，使用SBox.s_box_1()方法将每个十进制值替换为S盒中的值，
然后将每个替换后的值转换为8位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
Line_Shift(String a)  
该方法接受一个16位的二进制字符串a，并返回一个16位的二进制字符串。该方法将输入字符串分成四个4位的字符串，将这些字符串重新排列，然后将它们连接成一个16位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
Column_Confusion(String a)  
该方法接受一个16位的二进制字符串a，并返回一个16位的二进制字符串。该方法将输入字符串分成四个4位的字符串，将每个4位字符串转换为十进制，将这些十进制值存储在一个数组中。
然后，该方法使用特定的算法对该数组进行操作，以生成一个新的数组。最后，该方法将新数组中的每个十进制值转换为4位的二进制字符串，并将这些字符串连接成一个16位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
Column_Confusion_1(String a)  
该方法接受一个16位的二进制字符串a，并返回一个16位的二进制字符串。该方法将输入字符串分成四个4位的字符串，将每个4位字符串转换为十进制，将这些十进制值存储在一个数组中。
然后，该方法使用特定的算法对该数组进行操作，以生成一个新的数组。最后，该方法将新数组中的每个十进制值转换为4位的二进制字符串，并将这些字符串连接成一个16位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
multiplyGF2_4(int a, int b)  
该方法接受两个4位的十进制数a和b，并返回它们的乘积。该方法使用特定的算法计算两个数的乘积，并返回一个4位的十进制数。  
  
key_addition(String In, String Kn)  
该方法接受两个16位的二进制字符串In和Kn，并返回一个16位的二进制字符串。该方法将输入字符串分成单个字符，将每个字符转换为0或1，并将它们存储在一个数组中。然后，该方法将两个数组中的每个元素进行异或运算，
并将结果存储在一个新的数组中。最后，该方法将新数组中的每个元素转换为0或1，并将它们连接成一个16位的二进制字符串。该方法返回一个16位的二进制字符串。  
  
3.KeyExpansion类提供了用于使用给定的16位密钥生成AES加密轮密钥的方法。该类包含以下方法：  
shift(int w)  
此方法接受一个8位整数w并返回一个8位整数w_next。该方法交换w的左右半字节并返回结果。  
sub_byte(int w)  
此方法接受一个8位整数w并返回一个8位整数w_next。该方法对w应用S-box替换并返回结果。  
g1(int w)  
此方法接受一个8位整数w并返回一个8位整数w_next。该方法将shift()和sub_byte()方法应用于w，将结果与rcon1异或，并返回结果。  
g2(int w)  
此方法接受一个8位整数w并返回一个8位整数w_next。该方法将shift()和sub_byte()方法应用于w，将结果与rcon2异或，并返回结果。  
key_Expansion(int Key)  
此方法接受一个16位整数Key并返回一个由6个8位整数组成的数组，表示轮密钥。该方法通过首先将密钥分成两个8位整数p1和p2，然后应用g1()和g2()方法来生成其余的轮密钥。该方法将轮密钥作为由6个8位整数组成的数组返回，
每对整数表示一个单独的轮密钥。  
  
4.AttackInMiddle类提供了一种攻击AES加密算法的方法，该方法使用明文和密文作为输入，生成可能的密钥并返回。该类包含以下方法：  
attack(String PlainText, String CipherText)  
该方法接受明文和密文作为输入，并返回一个字符串数组，其中包含可能的密钥。该方法使用两个循环，分别生成所有可能的密钥，并将它们与密文进行解密，然后将解密后的明文与输入的明文进行比较。如果它们相等，
则将密钥添加到输出数组中。该方法返回一个字符串数组，其中每个字符串都表示一个可能的密钥。  
main(String[] args)  
该方法接受用户输入的明文和密文，并调用attack()方法来破解AES加密算法。该方法打印出所有可能的密钥，并显示破解所需的时间。  
  
5.Cipher类提供了使用给定密钥对明文进行SAES加密的方法。该类包含以下方法：  
cipher(String input, String Key)  
该方法接受一个明文字符串input和一个16位密钥字符串Key，并返回一个密文字符串。该方法首先使用密钥和输入执行密钥加法，然后对结果应用Round_1和Round_2方法，并返回最终的密文。  
cipher2(String input, String key)  
该方法接受一个明文字符串input和一个32位密钥字符串key，并返回一个密文字符串。该方法首先将密钥分成两个16位密钥，并使用第一个密钥对输入应用cipher方法。然后，
使用第二个密钥将生成的密文作为输入再次应用cipher方法。返回最终的密文。  
cipher3(String input, String key)  
该方法接受一个明文字符串input和一个48位密钥字符串key，并返回一个密文字符串。该方法首先将密钥分成三个16位密钥，并使用第一个密钥对输入应用cipher方法。然后，
使用Decipher类的decipher方法和第二个密钥解密生成的密文。然后，将生成的明文作为输入再次使用cipher方法，这次使用第三个密钥。返回最终的密文。  
Round_1(String a,String Key)  
该方法接受一个16位字符串a和一个16位密钥字符串Key，并返回一个16位字符串。该方法首先对a应用Half_Byte_Replace、Line_Shift和Column_Confusion方法，
然后使用KeyExpansion类的key_Expansion方法从Key生成的密钥计划的前两个字应用密钥加法。返回结果字符串。  
Round_2(String a,String Key)  
该方法接受一个16位字符串a和一个16位密钥字符串Key，并返回一个16位字符串。该方法首先对a应用Half_Byte_Replace和Line_Shift方法，然后使用KeyExpansion类的key_Expansion方法从Key生成的密钥计划的第三个
和第四个字应用密钥加法。返回结果字符串。  
  
6.解密类类似于加密类的接口文档。  
  
四、注意事项：
-
1.该代码使用的是SAES算法，密钥长度为16位。  
2.在中间相遇攻击过程中，由于结果过多，可能会导致运行时间过长。  
3.程序中使用了Scanner类来读取用户输入，因此需要确保输入的格式正确。  
4.中间相遇攻击程序中使用了long类型来存储时间，因此需要确保时间的单位正确。  
5.该SAES程序仅可用于简单的明密文加密，并不能够用于专业的加解密。  
